### 1. 全局执行上下文

1.  在执行全局代码前，将 window 对象确定为全局执行上下文。
2.  对全局数据进行预处理
    - var 定义的全局变量 -> undefined,添加为 window 的属性
    - function 定义的全局函数 -> 赋值 fun，添加为 window 的方法
    - this -> 赋值 window
3.  开始执行全局代码

### 2. 局部执行上下文

1.  在调用函数，准备执行函数体之前，创建对应的函数执行上下文对象
2.  对局部数据进行预处理
    - 形参变量 -> 赋值实参 -> 添加为执行上下文的属性
    - arguments -> 赋值实参列表，添加为执行上下文的属性
    - var 定义的局部变量 -> 赋值 undefined，添加为执行上下文的属性
    - function 声明的函数 -> 赋值 function，添加为执行上下文的方法
    - this -> 赋值为调用函数的对象
3.  开始执行函数体

### 3. 执行上下文栈

1.  在全局代码执行之前，Js 引擎就会创建一个 **栈** 来储存所有的执行上下文对象
2.  在全局执行上下文 window 确定之后，将其添加到栈中 （进栈）
3.  在函数执行上下文创建之后，将其添加到栈中 （进栈）
4.  当前函数执行完之后，讲栈顶的函数移除 （出栈）
5.  当所有代码执行完成后，栈中只剩下 window

```javascript
var a = 10;
var bar = function (x) {
  var b = 5;
  foo(x + 5);
};

var foo = function (y) {
  var c = 5;
  console.log(a + c + 5);
};

bar(10);
```

![上下文对象](https://github.com/pangbooo/Typescrpt/blob/javascript-advanced-shangguigu/imgs/%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AF%B9%E8%B1%A1.png)
