 ![线程和进程](https://github.com/pangbooo/Typescrpt/blob/javascript-advanced-shangguigu/imgs/线程和进程.png)
### 1. 进程
* 程序的一次执行，它占有一片独有内存空间
* 可以通过windows进程管理器查看进程

### 2. 线程
* 线程是进城内的一个独立执行单元
* 是程序执行的一个完整流程
* 是CPU的最小调度单元

### 3. Js是单线程的
JavaScript语言的一大特点就是单线程，也就是说，同一个时间只能做一件事。那么，为什么JavaScript不能有多个线程呢？这样能提高效率啊。

JavaScript的单线程，与它的用途有关。作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。比如，假定JavaScript同时有两个线程，一个线程在某个DOM节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？

所以，为了避免复杂性，从一诞生，JavaScript就是单线程，这已经成了这门语言的核心特征，将来也不会改变。

为了利用多核CPU的计算能力，HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质。

### 4. 相关知识
* 应用程序必须运行在某个进程的某个线程上
* 一个进程中至少有一个运行的线程：主线程。在程序启动后自动创建
* 一个进程中可以有多个线程，称为程序是多线程。
* 一个进程内的数据可供这个进程中的多个线程共享
* 多个进程之前的数据不能共享
* 线程池（thread pool）- 保存多个线程对象的容器，实现线程对象的复用

### 5. 浏览器事件循环机制
 ![浏览器事件循环机制](https://github.com/pangbooo/Typescrpt/blob/javascript-advanced-shangguigu/imgs/浏览器事件循环机制.png)
 #### 5.1 Js代码分类
  1. 初始化代码（同步执行）包含：绑定事件监听，设置定时器...
  2. 回调函数（异步执行）：处理回调函数
#### 5.2 Js引擎先处理初始代码（同步代码），再执行回调函数（异步代码）
#### 5.3 模式的运转流程
  1. 执行初始代码：将事件回调函数交给对应模块管理
  2. 当事件发生时，管理模块会将回调函数交给回调队列
  3. 只有初始代码执行完之后，才会遍历读取回调队列中的事件。

  ### 6. 宏任务和微任务
   ![微任务和宏任务](https://github.com/pangbooo/Typescrpt/blob/javascript-advanced-shangguigu/imgs/微任务和宏任务.png)
  * 宏任务
    * 执行整体的js代码
    * 事件回调
    * 定时器（setTimeout/setInterval/setImmediate）
    * XHR回调
    * IO操作
    * UI render

  * 微任务
    * ⚠️promise回调 -> 当promise的状态变成fullfilled之后，回调函数.then() 内部的注册到微事件
    * process.nextTick （nodeJs）
    * setImmediate （nodeJs）
    * MutationObserver
    * Object.observe

